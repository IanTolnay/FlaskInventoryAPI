openapi: 3.1.0
info:
  title: Inventory API
  description: Live inventory data from a Google Sheet
  version: "1.0"
servers:
  - url: https://flask-inventory-api.onrender.com
paths:
  /inventory/{sheet_name}:
    get:
      operationId: getInventoryBySheet
      summary: Get all inventory from a Google Sheet tab
      description: |
        Returns all inventory items listed in the given sheet_name tab of the spreadsheet.
        Example prompt: "Show me everything in sheet Main"
      parameters:
        - name: sheet_name
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of inventory rows
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
        "400":
          description: Could not access sheet

  /inventory/item/{sheet_name}/{item_name}:
    get:
      operationId: getInventoryItemBySheet
      summary: Get item details by name from a specific sheet
      description: |
        Returns details for a specific item from the specified sheet.
        Example prompt: "What is the status of device UPS in sheet Devices"
      parameters:
        - name: sheet_name
          in: path
          required: true
          schema:
            type: string
        - name: item_name
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Inventory item details
          content:
            application/json:
              schema:
                type: object
                properties: {}
        "404":
          description: Item not found

  /location/{sheet_name}/{location_id}:
    get:
      operationId: getByLocationBySheet
      summary: Get all items stored at a specific location in a sheet
      description: |
        Returns a list of inventory items stored at the specified location in the given sheet.
        Example prompt: "Whatâ€™s in location 3B on sheet Inventory_Tracker?"
      parameters:
        - name: sheet_name
          in: path
          required: true
          schema:
            type: string
        - name: location_id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of items at location
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
        "404":
          description: Location not found

  /sheet/update_structure:
    post:
      operationId: updateSheetStructure
      summary: Remove columns from a sheet
      description: |
        Removes specified columns from a sheet by updating the header row and clearing their values from all entries.
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sheet_name
              properties:
                sheet_name:
                  type: string
                  description: Name of the sheet to modify
                remove_columns:
                  type: array
                  items:
                    type: string
                  description: List of column headers to remove
      responses:
        "200":
          description: Sheet structure updated
        "400":
          description: Sheet not found or update failed

  /sheet/set_headers:
    post:
      operationId: setSheetHeaders
      summary: Replace sheet headers with a new set
      description: |
        Replaces the current headers in the specified sheet with a new list of headers. This action clears the first row and inserts the new headers.
        Authentication is required via an API key passed as a query parameter.
      parameters:
        - name: key
          in: query
          required: true
          schema:
            type: string
          description: API key used for authorization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sheet_name
                - headers
              properties:
                sheet_name:
                  type: string
                  description: Name of the sheet to update
                headers:
                  type: array
                  items:
                    type: string
                  description: New list of column headers
      responses:
        "200":
          description: Headers updated successfully
        "400":
          description: Bad request or missing fields
        "401":
          description: Unauthorized access
